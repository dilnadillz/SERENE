<%- include('../adminlayouts/header.ejs') %>


      <!-- partial -->
     
      <div class="main-panel">
        <div class="content-wrapper">
          <div class="page-header">
            <h3 class="page-title"> Sales Report </h3>
            <nav aria-label="breadcrumb">
    
            </nav>
          </div>
    
         <!-- Your HTML Structure -->

<div class="row">
  <div class="col-md-12 grid-margin stretch-card">
      <div class="card">
          <div class="card-body">
              <h4 class="card-title">Sales</h4>
              <form id="salesReportForm" method="GET" action="/admin/salesReportFilter" onsubmit="return validateDates()">
                <div class="form-row align-items-center">
                    <div class="col-md-3">
                        <label for="startDate">Start Date:</label>
                        <input type="date" id="startDate" name="startDate" class="form-control" value="<%#= defaultStartDate %>">
                    </div>
                    <div class="col-md-3">
                        <label for="endDate">End Date:</label>
                        <input type="date" id="endDate" name="endDate" class="form-control" value="<%#= defaultEndDate %>">
                    </div>
                    <div class="col-md-3">
                        <button type="submit" id="submitBtn" class="action-btn block-btn btn-lg btn-gradient-primary mt-4">Submit</button>
                    </div>
                </div>
            </form><br><br>
              <div class="table-responsive">
                <table class="table">
                  <thead>
                      <tr>
                        <th>Order Id</th>
                        <th>Product Name</th>
                        <th>Date</th>
                        <!-- <th>Quantity</th> -->
                        <!-- <th>Price</th> -->
                        <th>Payment</th>
                       
                      </tr>
                  </thead>
                  <tbody>
                      <% salesData.forEach(sales => { %>
                          <tr>
                            
                              <td><%= sales._id.toString().slice(-6) %></td>
                              <td><%= sales.details[0].productId.productName %></td>
                              <td><%= sales.date.toLocaleDateString() %></td>
                              <!-- <td><%#= sales.quantity %></td> -->
                              <!-- <td><%#= sales.price %></td> -->
                              <td><%= sales.payment %></td>
                            
                          
                          </tr>
                      <% }); %>
                  </tbody>
              </table>
              </div>
              <button type="button" id="downloadBtn" class="btn btn-light btn-download">Download Report (PDF)</button>

          </div>
      </div>
  </div>
</div>
<div class="pagination justify-content-center mt-4">
  <ul class="pagination">
      <% if (currentPage > 1) { %>
          <li class="page-item">
              <a class="page-link" href="?page=<%= currentPage - 1 %>" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
              </a>
          </li>
      <% } %>

      <% for(let i = 1; i <= totalPages; i++) { %>
          <li class="page-item <%= i === currentPage ? 'active' : '' %>">
              <a class="page-link" href="?page=<%= i %>"><%= i %></a>
          </li>
      <% } %>

      <% if (currentPage < totalPages) { %>
          <li class="page-item">
              <a class="page-link" href="?page=<%= currentPage + 1 %>" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
              </a>
          </li>
      <% } %>
  </ul>
</div>


<script>
    document.getElementById('downloadBtn').addEventListener('click', async () => {
      try {
        const startDate = document.getElementById('startDate').value;
        const endDate = document.getElementById('endDate').value;
        const response = await fetch(`/admin/salesPdf?startDate=${startDate}&endDate=${endDate}`);
        if (response.ok) {
          window.location.href = '/admin/salesPdf';
        } else {
          console.error('Failed to fetch sales report data');
        }
      } catch (error) {
        console.error('An error occurred:', error);
      }
    });
  </script>
  


  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <style>
      .container {
          padding: 20px;
      }

      .report-header {
          margin-bottom: 20px;
      }

      .report-table {
          width: 100%;
          border-collapse: collapse;
      }

      .report-table th,
      .report-table td {
          border: 1px solid #ddd;
          padding: 8px;
          text-align: left;
      }

      .report-table th {
          background-color: #f2f2f2;
      }

      .report-table tr:nth-child(even) {
          background-color: #f9f9f9;
      }

      .report-table tr:hover {
          background-color: #f1f1f1;
      }

      .btn-download {
          margin-top: 20px;
      }
  </style>
      
   
      <!-- partial -->
    </div>
    <!-- main-panel ends -->
  </div>
  <!-- page-body-wrapper ends -->
  </div>
  <!-- container-scroller -->
  <!-- plugins:js -->
  <script src="/assetsadmin/vendors/js/vendor.bundle.base.js"></script>
  <!-- endinject -->
  <!-- Plugin js for this page -->
  <script src="/assetsadmin/vendors/chart.js/Chart.min.js"></script>
  <script src="/assetsadmin/js/jquery.cookie.js" type="text/javascript"></script>
  <!-- End plugin js for this page -->
  <!-- inject:js -->
  <script src="/assetsadmin/js/off-canvas.js"></script>
  <script src="/assetsadmin/js/hoverable-collapse.js"></script>
  <script src="/assetsadmin/js/misc.js"></script>
  <!-- endinject -->
  <!-- Custom js for this page -->
  <script src="/assetsadmin/js/dashboard.js"></script>
  <script src="/assetsadmin/js/todolist.js"></script>
  <!-- End custom js for this page -->
</body>

<!-- Mirrored from demo.bootstrapdash.com/purple-admin-free/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 28 Dec 2023 06:57:42 GMT -->

</html>


<%- include('../adminlayouts/footer.ejs') %>